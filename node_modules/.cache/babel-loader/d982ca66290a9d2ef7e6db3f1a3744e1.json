{"ast":null,"code":"var _jsxFileName = \"/Users/Megan/Flatiron_School/hikr-front-end/hikr-front-end/src/components/Map.js\";\nimport React, { Component } from 'react';\nimport mapboxgl from 'mapbox-gl';\nimport { Button } from 'react-bootstrap';\nimport '../map.css';\nmapboxgl.accessToken = `${process.env.REACT_APP_MAPBOX_API_KEY}`;\n\nclass Map extends Component {\n  constructor(props) {\n    super(props);\n\n    this.makeGeoJSON = trail => {\n      return {\n        type: 'Feature',\n        geometry: {\n          type: 'Point',\n          coordinates: [trail.longitude, trail.latitude]\n        },\n        properties: {\n          id: trail.id,\n          name: trail.name,\n          city: trail.location,\n          summary: trail.summary,\n          difficulty: trail.difficulty,\n          stars: trail.stars,\n          img_url: trail.imgSmall,\n          length: trail.length,\n          condition: trail.conditionStatus,\n          conditionDate: trail.conditionDate\n        }\n      };\n    };\n\n    this.state = {\n      lng: props.lon,\n      lat: props.lat,\n      zoom: 9\n    };\n  }\n\n  componentDidMount() {\n    let trailsUrl = 'https://www.hikingproject.com/data/get-trails?lat=' + `${this.state.lat}` + '&lon=' + `${this.state.lng}` + '&maxDistance=10&key=' + `${process.env.REACT_APP_HIKING_PROJECT_API_KEY}`;\n    console.log(trailsUrl);\n    fetch(trailsUrl).then(res => res.json()).then(result => {\n      result.trails.forEach(trail => stores.features.push(this.makeGeoJSON(trail)));\n    });\n    let stores = {\n      type: 'FeatureCollection',\n      features: []\n    };\n    /**\n     * Assign a unique id to each store. You'll use this `id`\n     * later to associate each point on the map with a listing\n     * in the sidebar.\n     */\n\n    stores.features.forEach(function (store, i) {\n      store.properties.id = i;\n    });\n    console.log(stores);\n    const map = new mapboxgl.Map({\n      container: this.mapContainer,\n      style: 'mapbox://styles/mapbox/streets-v11',\n      center: [this.state.lng, this.state.lat],\n      zoom: this.state.zoom // scrollZoom: true\n\n    });\n    map.on('move', () => {\n      this.setState({\n        lng: map.getCenter().lng.toFixed(4),\n        lat: map.getCenter().lat.toFixed(4),\n        zoom: map.getZoom().toFixed(2)\n      });\n    });\n    /**\n     * Add geolocate control to the map.\n     **/\n\n    map.addControl(new mapboxgl.GeolocateControl({\n      positionOptions: {\n        enableHighAccuracy: true\n      },\n      trackUserLocation: true\n    }));\n    /**\n     * Add zoom and rotation controls to the map.\n     **/\n\n    map.addControl(new mapboxgl.NavigationControl());\n    /**\n     * Wait until the map loads to make changes to the map.\n     */\n\n    map.on('load', function (e) {\n      /**\n       * This is where your '.addLayer()' used to be, instead\n       * add only the source without styling a layer\n       */\n      map.addSource('places', {\n        type: 'geojson',\n        data: stores\n      });\n      /**\n       * Add all the things to the page:\n       * - The location listings on the side of the page\n       * - The markers onto the map\n       */\n\n      buildLocationList(stores);\n      addMarkers();\n    });\n\n    function displayDifficulty(difficulty) {\n      if (difficulty == 'green') {\n        return 'easy';\n      } else if (difficulty == 'blue') {\n        return 'intermediate';\n      } else if (difficulty == 'blueBlack') {\n        return 'intermediate/difficult';\n      } else {\n        return 'difficult';\n      }\n    }\n    /**\n     * Add a listing for each store to the sidebar.\n     **/\n\n\n    function buildLocationList(data) {\n      const listings = document.getElementById('listings');\n      listings.innerHTML = \"\";\n      data.features.forEach(function (store, i) {\n        /**\n         * Create a shortcut for `store.properties`,\n         * which will be used several times below.\n         **/\n        const prop = store.properties;\n        /* Add a new listing section to the sidebar. */\n\n        const listing = listings.appendChild(document.createElement('div'));\n        /* Assign a unique `id` to the listing. */\n\n        listing.id = 'listing-' + prop.id;\n        /* Assign the `item` class to each listing for styling. */\n\n        listing.className = 'item';\n        /* Add the link to the individual listing created above. */\n\n        const link = listing.appendChild(document.createElement('a'));\n        link.href = '#';\n        link.className = 'name';\n        link.id = 'link-' + prop.id;\n        link.innerHTML = prop.name;\n        /* Add details to the individual listing. */\n\n        const details = listing.appendChild(document.createElement('div'));\n        details.innerHTML = '<Button>' + displayDifficulty(prop.difficulty) + '</Button>';\n        details.innerHTML += prop.stars;\n        const extraDetails = listing.appendChild(document.createElement('div'));\n        extraDetails.innerHTML = prop.city;\n        /**\n         * Listen to the element and when it is hovered, do four things:\n         * 1. Update the `currentFeature` to the store associated with the clicked link\n         * 2. Fly to the point\n         * 3. Close all other popups and display popup for clicked store\n         * 4. Highlight listing in sidebar (and remove highlight for all other listings)\n         **/\n\n        link.addEventListener('mouseover', function (e) {\n          for (let i = 0; i < data.features.length; i++) {\n            if (this.id === 'link-' + data.features[i].properties.id) {\n              var clickedListing = data.features[i];\n              flyToStore(clickedListing);\n              createPopUp(clickedListing);\n            }\n          }\n\n          const activeItem = document.getElementsByClassName('active');\n\n          if (activeItem[0]) {\n            activeItem[0].classList.remove('active');\n          }\n\n          this.parentNode.classList.add('active');\n        });\n      });\n    }\n    /**\n     * Add a marker to the map for every store listing.\n     **/\n\n\n    function addMarkers() {\n      /* For each feature in the GeoJSON object above: */\n      stores.features.forEach(function (marker) {\n        /* Create a div element for the marker. */\n        var el = document.createElement('div');\n        /* Assign a unique `id` to the marker. */\n\n        el.id = 'marker-' + marker.properties.id;\n        /* Assign the `marker` class to each marker for styling. */\n\n        el.className = 'marker';\n        /**\n         * Create a marker using the div element\n         * defined above and add it to the map.\n         **/\n\n        new mapboxgl.Marker(el, {\n          offset: [0, -23]\n        }).setLngLat(marker.geometry.coordinates).addTo(map);\n        /**\n         * Listen to the element and when it is clicked, do three things:\n         * 1. Fly to the point\n         * 2. Close all other popups and display popup for clicked store\n         * 3. Highlight listing in sidebar (and remove highlight for all other listings)\n         **/\n\n        el.addEventListener('click', function (e) {\n          /* Fly to the point */\n          flyToStore(marker);\n          /* Close all other popups and display popup for clicked store */\n\n          createPopUp(marker);\n          /* Highlight listing in sidebar */\n\n          var activeItem = document.getElementsByClassName('active');\n          e.stopPropagation();\n\n          if (activeItem[0]) {\n            activeItem[0].classList.remove('active');\n          }\n\n          var listing = document.getElementById('listing-' + marker.properties.id);\n          listing.classList.add('active');\n        });\n      });\n    }\n    /**\n     * Use Mapbox GL JS's `flyTo` to move the camera smoothly\n     * a given center point.\n     **/\n\n\n    function flyToStore(currentFeature) {\n      map.flyTo({\n        center: currentFeature.geometry.coordinates,\n        zoom: 15\n      });\n    }\n    /**\n     * Create a Mapbox GL JS `Popup`.\n     **/\n\n\n    function createPopUp(currentFeature) {\n      var popUps = document.getElementsByClassName('mapboxgl-popup');\n      if (popUps[0]) popUps[0].remove();\n      var popup = new mapboxgl.Popup({\n        closeOnClick: false\n      }).setLngLat(currentFeature.geometry.coordinates).setHTML('<h3>' + currentFeature.properties.name + '</h3>' + '<h5>' + currentFeature.properties.summary + '</h5>' + '<img src=' + currentFeature.properties.img_url + '>' + '<h5>Current conditions: ' + currentFeature.properties.condition + '</h5>').addTo(map);\n    }\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 282\n      },\n      __self: this\n    }, React.createElement(\"h3\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 283\n      },\n      __self: this\n    }, \"FROM MAP.JS\"), React.createElement(\"div\", {\n      className: \"sidebar\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 291\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"heading\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 292\n      },\n      __self: this\n    }, React.createElement(\"h1\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 293\n      },\n      __self: this\n    }, \"Hiking Trails\")), React.createElement(\"div\", {\n      id: \"listings\",\n      className: \"listings\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 295\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      ref: el => this.mapContainer = el,\n      className: \"map\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 297\n      },\n      __self: this\n    }));\n  }\n\n}\n\nexport default Map;","map":{"version":3,"sources":["/Users/Megan/Flatiron_School/hikr-front-end/hikr-front-end/src/components/Map.js"],"names":["React","Component","mapboxgl","Button","accessToken","process","env","REACT_APP_MAPBOX_API_KEY","Map","constructor","props","makeGeoJSON","trail","type","geometry","coordinates","longitude","latitude","properties","id","name","city","location","summary","difficulty","stars","img_url","imgSmall","length","condition","conditionStatus","conditionDate","state","lng","lon","lat","zoom","componentDidMount","trailsUrl","REACT_APP_HIKING_PROJECT_API_KEY","console","log","fetch","then","res","json","result","trails","forEach","stores","features","push","store","i","map","container","mapContainer","style","center","on","setState","getCenter","toFixed","getZoom","addControl","GeolocateControl","positionOptions","enableHighAccuracy","trackUserLocation","NavigationControl","e","addSource","data","buildLocationList","addMarkers","displayDifficulty","listings","document","getElementById","innerHTML","prop","listing","appendChild","createElement","className","link","href","details","extraDetails","addEventListener","clickedListing","flyToStore","createPopUp","activeItem","getElementsByClassName","classList","remove","parentNode","add","marker","el","Marker","offset","setLngLat","addTo","stopPropagation","currentFeature","flyTo","popUps","popup","Popup","closeOnClick","setHTML","render"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAOC,QAAP,MAAqB,WAArB;AACA,SAASC,MAAT,QAAuB,iBAAvB;AACA,OAAO,YAAP;AAEAD,QAAQ,CAACE,WAAT,GAAwB,GAAEC,OAAO,CAACC,GAAR,CAAYC,wBAAyB,EAA/D;;AAGA,MAAMC,GAAN,SAAkBP,SAAlB,CAA4B;AAC1BQ,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACjB,UAAMA,KAAN;;AADiB,SASnBC,WATmB,GASJC,KAAD,IAAW;AAEvB,aACE;AACEC,QAAAA,IAAI,EAAE,SADR;AAEEC,QAAAA,QAAQ,EAAE;AACRD,UAAAA,IAAI,EAAE,OADE;AAERE,UAAAA,WAAW,EAAE,CAACH,KAAK,CAACI,SAAP,EAAkBJ,KAAK,CAACK,QAAxB;AAFL,SAFZ;AAMEC,QAAAA,UAAU,EAAE;AACVC,UAAAA,EAAE,EAAEP,KAAK,CAACO,EADA;AAEVC,UAAAA,IAAI,EAAER,KAAK,CAACQ,IAFF;AAGVC,UAAAA,IAAI,EAAET,KAAK,CAACU,QAHF;AAIVC,UAAAA,OAAO,EAAEX,KAAK,CAACW,OAJL;AAKVC,UAAAA,UAAU,EAAEZ,KAAK,CAACY,UALR;AAMVC,UAAAA,KAAK,EAAEb,KAAK,CAACa,KANH;AAOVC,UAAAA,OAAO,EAAEd,KAAK,CAACe,QAPL;AAQVC,UAAAA,MAAM,EAAEhB,KAAK,CAACgB,MARJ;AASVC,UAAAA,SAAS,EAAEjB,KAAK,CAACkB,eATP;AAUVC,UAAAA,aAAa,EAAEnB,KAAK,CAACmB;AAVX;AANd,OADF;AAqBD,KAhCkB;;AAEjB,SAAKC,KAAL,GAAa;AACXC,MAAAA,GAAG,EAAEvB,KAAK,CAACwB,GADA;AAEXC,MAAAA,GAAG,EAAEzB,KAAK,CAACyB,GAFA;AAGXC,MAAAA,IAAI,EAAE;AAHK,KAAb;AAKD;;AA2BDC,EAAAA,iBAAiB,GAAG;AAClB,QAAIC,SAAS,GAAG,uDAAwD,GAAE,KAAKN,KAAL,CAAWG,GAAI,EAAzE,GAA6E,OAA7E,GAAwF,GAAE,KAAKH,KAAL,CAAWC,GAAI,EAAzG,GAA6G,sBAA7G,GAAuI,GAAE5B,OAAO,CAACC,GAAR,CAAYiC,gCAAiC,EAAtM;AACAC,IAAAA,OAAO,CAACC,GAAR,CAAYH,SAAZ;AACAI,IAAAA,KAAK,CAACJ,SAAD,CAAL,CACCK,IADD,CACMC,GAAG,IAAIA,GAAG,CAACC,IAAJ,EADb,EAECF,IAFD,CAGGG,MAAD,IAAY;AACVA,MAAAA,MAAM,CAACC,MAAP,CAAcC,OAAd,CAAsBpC,KAAK,IAAIqC,MAAM,CAACC,QAAP,CAAgBC,IAAhB,CAAqB,KAAKxC,WAAL,CAAiBC,KAAjB,CAArB,CAA/B;AAED,KANH;AASA,QAAIqC,MAAM,GAAG;AACXpC,MAAAA,IAAI,EAAE,mBADK;AAEXqC,MAAAA,QAAQ,EAAE;AAFC,KAAb;AAKA;;;;;;AAKAD,IAAAA,MAAM,CAACC,QAAP,CAAgBF,OAAhB,CAAwB,UAASI,KAAT,EAAgBC,CAAhB,EAAmB;AACzCD,MAAAA,KAAK,CAAClC,UAAN,CAAiBC,EAAjB,GAAsBkC,CAAtB;AACD,KAFD;AAIAb,IAAAA,OAAO,CAACC,GAAR,CAAYQ,MAAZ;AACA,UAAMK,GAAG,GAAG,IAAIpD,QAAQ,CAACM,GAAb,CAAiB;AAC3B+C,MAAAA,SAAS,EAAE,KAAKC,YADW;AAE3BC,MAAAA,KAAK,EAAE,oCAFoB;AAG3BC,MAAAA,MAAM,EAAE,CAAC,KAAK1B,KAAL,CAAWC,GAAZ,EAAiB,KAAKD,KAAL,CAAWG,GAA5B,CAHmB;AAI3BC,MAAAA,IAAI,EAAE,KAAKJ,KAAL,CAAWI,IAJU,CAK3B;;AAL2B,KAAjB,CAAZ;AAQAkB,IAAAA,GAAG,CAACK,EAAJ,CAAO,MAAP,EAAe,MAAM;AACnB,WAAKC,QAAL,CAAc;AACZ3B,QAAAA,GAAG,EAAEqB,GAAG,CAACO,SAAJ,GAAgB5B,GAAhB,CAAoB6B,OAApB,CAA4B,CAA5B,CADO;AAEZ3B,QAAAA,GAAG,EAAEmB,GAAG,CAACO,SAAJ,GAAgB1B,GAAhB,CAAoB2B,OAApB,CAA4B,CAA5B,CAFO;AAGZ1B,QAAAA,IAAI,EAAEkB,GAAG,CAACS,OAAJ,GAAcD,OAAd,CAAsB,CAAtB;AAHM,OAAd;AAKD,KAND;AAQA;;;;AAGAR,IAAAA,GAAG,CAACU,UAAJ,CACE,IAAI9D,QAAQ,CAAC+D,gBAAb,CAA8B;AAC5BC,MAAAA,eAAe,EAAE;AACfC,QAAAA,kBAAkB,EAAE;AADL,OADW;AAI5BC,MAAAA,iBAAiB,EAAE;AAJS,KAA9B,CADF;AASA;;;;AAGAd,IAAAA,GAAG,CAACU,UAAJ,CAAe,IAAI9D,QAAQ,CAACmE,iBAAb,EAAf;AAEA;;;;AAGAf,IAAAA,GAAG,CAACK,EAAJ,CAAO,MAAP,EAAe,UAASW,CAAT,EAAY;AACzB;;;;AAIAhB,MAAAA,GAAG,CAACiB,SAAJ,CAAc,QAAd,EAAwB;AACtB1D,QAAAA,IAAI,EAAE,SADgB;AAEtB2D,QAAAA,IAAI,EAAEvB;AAFgB,OAAxB;AAKA;;;;;;AAKAwB,MAAAA,iBAAiB,CAACxB,MAAD,CAAjB;AACAyB,MAAAA,UAAU;AACX,KAjBD;;AAmBA,aAASC,iBAAT,CAA2BnD,UAA3B,EAAuC;AACrC,UAAGA,UAAU,IAAI,OAAjB,EAAyB;AACvB,eAAO,MAAP;AACD,OAFD,MAGK,IAAGA,UAAU,IAAI,MAAjB,EAAwB;AAC3B,eAAO,cAAP;AACD,OAFI,MAGA,IAAGA,UAAU,IAAI,WAAjB,EAA6B;AAChC,eAAO,wBAAP;AACD,OAFI,MAEE;AACL,eAAO,WAAP;AACD;AACF;AAGD;;;;;AAGA,aAASiD,iBAAT,CAA2BD,IAA3B,EAAiC;AAC/B,YAAMI,QAAQ,GAAGC,QAAQ,CAACC,cAAT,CAAwB,UAAxB,CAAjB;AACEF,MAAAA,QAAQ,CAACG,SAAT,GAAqB,EAArB;AACFP,MAAAA,IAAI,CAACtB,QAAL,CAAcF,OAAd,CAAsB,UAASI,KAAT,EAAgBC,CAAhB,EAAmB;AACvC;;;;AAIA,cAAM2B,IAAI,GAAG5B,KAAK,CAAClC,UAAnB;AAEA;;AACA,cAAM+D,OAAO,GAAGL,QAAQ,CAACM,WAAT,CAAqBL,QAAQ,CAACM,aAAT,CAAuB,KAAvB,CAArB,CAAhB;AACA;;AACAF,QAAAA,OAAO,CAAC9D,EAAR,GAAa,aAAa6D,IAAI,CAAC7D,EAA/B;AACA;;AACA8D,QAAAA,OAAO,CAACG,SAAR,GAAoB,MAApB;AAEA;;AACA,cAAMC,IAAI,GAAGJ,OAAO,CAACC,WAAR,CAAoBL,QAAQ,CAACM,aAAT,CAAuB,GAAvB,CAApB,CAAb;AACAE,QAAAA,IAAI,CAACC,IAAL,GAAY,GAAZ;AACAD,QAAAA,IAAI,CAACD,SAAL,GAAiB,MAAjB;AACAC,QAAAA,IAAI,CAAClE,EAAL,GAAU,UAAU6D,IAAI,CAAC7D,EAAzB;AACAkE,QAAAA,IAAI,CAACN,SAAL,GAAiBC,IAAI,CAAC5D,IAAtB;AAEA;;AACA,cAAMmE,OAAO,GAAGN,OAAO,CAACC,WAAR,CAAoBL,QAAQ,CAACM,aAAT,CAAuB,KAAvB,CAApB,CAAhB;AACAI,QAAAA,OAAO,CAACR,SAAR,GAAoB,aAAaJ,iBAAiB,CAACK,IAAI,CAACxD,UAAN,CAA9B,GAAkD,WAAtE;AACA+D,QAAAA,OAAO,CAACR,SAAR,IAAqBC,IAAI,CAACvD,KAA1B;AAEA,cAAM+D,YAAY,GAAGP,OAAO,CAACC,WAAR,CAAoBL,QAAQ,CAACM,aAAT,CAAuB,KAAvB,CAApB,CAArB;AACAK,QAAAA,YAAY,CAACT,SAAb,GAAyBC,IAAI,CAAC3D,IAA9B;AAEA;;;;;;;;AAQAgE,QAAAA,IAAI,CAACI,gBAAL,CAAsB,WAAtB,EAAmC,UAASnB,CAAT,EAAY;AAC7C,eAAK,IAAIjB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGmB,IAAI,CAACtB,QAAL,CAActB,MAAlC,EAA0CyB,CAAC,EAA3C,EAA+C;AAC7C,gBAAI,KAAKlC,EAAL,KAAY,UAAUqD,IAAI,CAACtB,QAAL,CAAcG,CAAd,EAAiBnC,UAAjB,CAA4BC,EAAtD,EAA0D;AACxD,kBAAIuE,cAAc,GAAGlB,IAAI,CAACtB,QAAL,CAAcG,CAAd,CAArB;AACAsC,cAAAA,UAAU,CAACD,cAAD,CAAV;AACAE,cAAAA,WAAW,CAACF,cAAD,CAAX;AACD;AACF;;AACD,gBAAMG,UAAU,GAAGhB,QAAQ,CAACiB,sBAAT,CAAgC,QAAhC,CAAnB;;AACA,cAAID,UAAU,CAAC,CAAD,CAAd,EAAmB;AACjBA,YAAAA,UAAU,CAAC,CAAD,CAAV,CAAcE,SAAd,CAAwBC,MAAxB,CAA+B,QAA/B;AACD;;AACD,eAAKC,UAAL,CAAgBF,SAAhB,CAA0BG,GAA1B,CAA8B,QAA9B;AACD,SAbD;AAcD,OAnDD;AAoDD;AAED;;;;;AAGA,aAASxB,UAAT,GAAsB;AACpB;AACAzB,MAAAA,MAAM,CAACC,QAAP,CAAgBF,OAAhB,CAAwB,UAASmD,MAAT,EAAiB;AACvC;AACA,YAAIC,EAAE,GAAGvB,QAAQ,CAACM,aAAT,CAAuB,KAAvB,CAAT;AACA;;AACAiB,QAAAA,EAAE,CAACjF,EAAH,GAAQ,YAAYgF,MAAM,CAACjF,UAAP,CAAkBC,EAAtC;AACA;;AACAiF,QAAAA,EAAE,CAAChB,SAAH,GAAe,QAAf;AAEA;;;;;AAIA,YAAIlF,QAAQ,CAACmG,MAAb,CAAoBD,EAApB,EAAwB;AAAEE,UAAAA,MAAM,EAAE,CAAC,CAAD,EAAI,CAAC,EAAL;AAAV,SAAxB,EACGC,SADH,CACaJ,MAAM,CAACrF,QAAP,CAAgBC,WAD7B,EAEGyF,KAFH,CAESlD,GAFT;AAIA;;;;;;;AAMA8C,QAAAA,EAAE,CAACX,gBAAH,CAAoB,OAApB,EAA6B,UAASnB,CAAT,EAAY;AACvC;AACAqB,UAAAA,UAAU,CAACQ,MAAD,CAAV;AACA;;AACAP,UAAAA,WAAW,CAACO,MAAD,CAAX;AACA;;AACA,cAAIN,UAAU,GAAGhB,QAAQ,CAACiB,sBAAT,CAAgC,QAAhC,CAAjB;AACAxB,UAAAA,CAAC,CAACmC,eAAF;;AACA,cAAIZ,UAAU,CAAC,CAAD,CAAd,EAAmB;AACjBA,YAAAA,UAAU,CAAC,CAAD,CAAV,CAAcE,SAAd,CAAwBC,MAAxB,CAA+B,QAA/B;AACD;;AACD,cAAIf,OAAO,GAAGJ,QAAQ,CAACC,cAAT,CACZ,aAAaqB,MAAM,CAACjF,UAAP,CAAkBC,EADnB,CAAd;AAGA8D,UAAAA,OAAO,CAACc,SAAR,CAAkBG,GAAlB,CAAsB,QAAtB;AACD,SAfD;AAgBD,OAtCD;AAuCD;AAGD;;;;;;AAIA,aAASP,UAAT,CAAoBe,cAApB,EAAoC;AAClCpD,MAAAA,GAAG,CAACqD,KAAJ,CAAU;AACRjD,QAAAA,MAAM,EAAEgD,cAAc,CAAC5F,QAAf,CAAwBC,WADxB;AAERqB,QAAAA,IAAI,EAAE;AAFE,OAAV;AAID;AAED;;;;;AAGA,aAASwD,WAAT,CAAqBc,cAArB,EAAqC;AACnC,UAAIE,MAAM,GAAG/B,QAAQ,CAACiB,sBAAT,CAAgC,gBAAhC,CAAb;AACA,UAAIc,MAAM,CAAC,CAAD,CAAV,EAAeA,MAAM,CAAC,CAAD,CAAN,CAAUZ,MAAV;AACf,UAAIa,KAAK,GAAG,IAAI3G,QAAQ,CAAC4G,KAAb,CAAmB;AAAEC,QAAAA,YAAY,EAAE;AAAhB,OAAnB,EACTR,SADS,CACCG,cAAc,CAAC5F,QAAf,CAAwBC,WADzB,EAETiG,OAFS,CAGR,SAASN,cAAc,CAACxF,UAAf,CAA0BE,IAAnC,GAA0C,OAA1C,GACE,MADF,GACWsF,cAAc,CAACxF,UAAf,CAA0BK,OADrC,GAC+C,OAD/C,GAEE,WAFF,GAEgBmF,cAAc,CAACxF,UAAf,CAA0BQ,OAF1C,GAEoD,GAFpD,GAGE,0BAHF,GAG+BgF,cAAc,CAACxF,UAAf,CAA0BW,SAHzD,GAGqE,OAN7D,EAQT2E,KARS,CAQHlD,GARG,CAAZ;AASD;AACF;;AAKD2D,EAAAA,MAAM,GAAG;AACP,WACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBADF,EASE;AAAK,MAAA,SAAS,EAAC,SAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAK,MAAA,SAAS,EAAC,SAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBADF,CADF,EAIE;AAAK,MAAA,EAAE,EAAC,UAAR;AAAmB,MAAA,SAAS,EAAC,UAA7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAJF,CATF,EAeE;AAAK,MAAA,GAAG,EAAEb,EAAE,IAAK,KAAK5C,YAAL,GAAoB4C,EAArC;AAA0C,MAAA,SAAS,EAAC,KAApD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAfF,CADF;AAoBD;;AApSyB;;AAuS5B,eAAe5F,GAAf","sourcesContent":["import React, { Component } from 'react'\nimport mapboxgl from 'mapbox-gl'\nimport { Button } from 'react-bootstrap'\nimport '../map.css'\n\nmapboxgl.accessToken = `${process.env.REACT_APP_MAPBOX_API_KEY}`\n\n\nclass Map extends Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      lng: props.lon,\n      lat: props.lat,\n      zoom: 9\n    }\n  }\n\n  makeGeoJSON = (trail) => {\n\n    return (\n      {\n        type: 'Feature',\n        geometry: {\n          type: 'Point',\n          coordinates: [trail.longitude, trail.latitude]\n        },\n        properties: {\n          id: trail.id,\n          name: trail.name,\n          city: trail.location,\n          summary: trail.summary,\n          difficulty: trail.difficulty,\n          stars: trail.stars,\n          img_url: trail.imgSmall,\n          length: trail.length,\n          condition: trail.conditionStatus,\n          conditionDate: trail.conditionDate\t\n        }\n      }\n    )\n  }\n\n  componentDidMount() {\n    let trailsUrl = 'https://www.hikingproject.com/data/get-trails?lat=' + `${this.state.lat}` + '&lon=' + `${this.state.lng}` + '&maxDistance=10&key=' + `${process.env.REACT_APP_HIKING_PROJECT_API_KEY}`\n    console.log(trailsUrl)\n    fetch(trailsUrl)\n    .then(res => res.json())\n    .then(\n      (result) => {\n        result.trails.forEach(trail => stores.features.push(this.makeGeoJSON(trail)))\n        \n      } \n    )\n\n    let stores = {\n      type: 'FeatureCollection',\n      features: []\n    }\n\n    /**\n     * Assign a unique id to each store. You'll use this `id`\n     * later to associate each point on the map with a listing\n     * in the sidebar.\n     */\n    stores.features.forEach(function(store, i) {\n      store.properties.id = i\n    })\n\n    console.log(stores)\n    const map = new mapboxgl.Map({\n      container: this.mapContainer,\n      style: 'mapbox://styles/mapbox/streets-v11',\n      center: [this.state.lng, this.state.lat],\n      zoom: this.state.zoom\n      // scrollZoom: true\n    })\n\n    map.on('move', () => {\n      this.setState({\n        lng: map.getCenter().lng.toFixed(4),\n        lat: map.getCenter().lat.toFixed(4),\n        zoom: map.getZoom().toFixed(2)\n      })\n    })\n\n    /**\n     * Add geolocate control to the map.\n     **/\n    map.addControl(\n      new mapboxgl.GeolocateControl({\n        positionOptions: {\n          enableHighAccuracy: true\n        },\n        trackUserLocation: true\n      })\n    )\n\n    /**\n     * Add zoom and rotation controls to the map.\n     **/\n    map.addControl(new mapboxgl.NavigationControl())\n\n    /**\n     * Wait until the map loads to make changes to the map.\n     */\n    map.on('load', function(e) {\n      /**\n       * This is where your '.addLayer()' used to be, instead\n       * add only the source without styling a layer\n       */\n      map.addSource('places', {\n        type: 'geojson',\n        data: stores\n      })\n\n      /**\n       * Add all the things to the page:\n       * - The location listings on the side of the page\n       * - The markers onto the map\n       */\n      buildLocationList(stores)\n      addMarkers()\n    })\n\n    function displayDifficulty(difficulty) {\n      if(difficulty == 'green'){\n        return 'easy'\n      }\n      else if(difficulty == 'blue'){\n        return 'intermediate'\n      }\n      else if(difficulty == 'blueBlack'){\n        return 'intermediate/difficult'\n      } else {\n        return 'difficult'\n      }\n    }\n\n\n    /**\n     * Add a listing for each store to the sidebar.\n     **/\n    function buildLocationList(data) {\n      const listings = document.getElementById('listings')\n        listings.innerHTML = \"\"\n      data.features.forEach(function(store, i) {\n        /**\n         * Create a shortcut for `store.properties`,\n         * which will be used several times below.\n         **/\n        const prop = store.properties\n\n        /* Add a new listing section to the sidebar. */\n        const listing = listings.appendChild(document.createElement('div'))\n        /* Assign a unique `id` to the listing. */\n        listing.id = 'listing-' + prop.id\n        /* Assign the `item` class to each listing for styling. */\n        listing.className = 'item'\n\n        /* Add the link to the individual listing created above. */\n        const link = listing.appendChild(document.createElement('a'))\n        link.href = '#'\n        link.className = 'name'\n        link.id = 'link-' + prop.id\n        link.innerHTML = prop.name\n\n        /* Add details to the individual listing. */\n        const details = listing.appendChild(document.createElement('div'))\n        details.innerHTML = '<Button>' + displayDifficulty(prop.difficulty) + '</Button>'\n        details.innerHTML += prop.stars\n\n        const extraDetails = listing.appendChild(document.createElement('div'))\n        extraDetails.innerHTML = prop.city\n\n        /**\n         * Listen to the element and when it is hovered, do four things:\n         * 1. Update the `currentFeature` to the store associated with the clicked link\n         * 2. Fly to the point\n         * 3. Close all other popups and display popup for clicked store\n         * 4. Highlight listing in sidebar (and remove highlight for all other listings)\n         **/\n\n        link.addEventListener('mouseover', function(e) {\n          for (let i = 0; i < data.features.length; i++) {\n            if (this.id === 'link-' + data.features[i].properties.id) {\n              var clickedListing = data.features[i]\n              flyToStore(clickedListing)\n              createPopUp(clickedListing)\n            }\n          }\n          const activeItem = document.getElementsByClassName('active')\n          if (activeItem[0]) {\n            activeItem[0].classList.remove('active')\n          }\n          this.parentNode.classList.add('active')\n        })\n      })\n    }\n\n    /**\n     * Add a marker to the map for every store listing.\n     **/\n    function addMarkers() {\n      /* For each feature in the GeoJSON object above: */\n      stores.features.forEach(function(marker) {\n        /* Create a div element for the marker. */\n        var el = document.createElement('div')\n        /* Assign a unique `id` to the marker. */\n        el.id = 'marker-' + marker.properties.id\n        /* Assign the `marker` class to each marker for styling. */\n        el.className = 'marker'\n\n        /**\n         * Create a marker using the div element\n         * defined above and add it to the map.\n         **/\n        new mapboxgl.Marker(el, { offset: [0, -23] })\n          .setLngLat(marker.geometry.coordinates)\n          .addTo(map)\n\n        /**\n         * Listen to the element and when it is clicked, do three things:\n         * 1. Fly to the point\n         * 2. Close all other popups and display popup for clicked store\n         * 3. Highlight listing in sidebar (and remove highlight for all other listings)\n         **/\n        el.addEventListener('click', function(e) {\n          /* Fly to the point */\n          flyToStore(marker)\n          /* Close all other popups and display popup for clicked store */\n          createPopUp(marker)\n          /* Highlight listing in sidebar */\n          var activeItem = document.getElementsByClassName('active')\n          e.stopPropagation()\n          if (activeItem[0]) {\n            activeItem[0].classList.remove('active')\n          }\n          var listing = document.getElementById(\n            'listing-' + marker.properties.id\n          )\n          listing.classList.add('active')\n        })\n      })\n    }\n\n  \n    /**\n     * Use Mapbox GL JS's `flyTo` to move the camera smoothly\n     * a given center point.\n     **/\n    function flyToStore(currentFeature) {\n      map.flyTo({\n        center: currentFeature.geometry.coordinates,\n        zoom: 15\n      })\n    }\n\n    /**\n     * Create a Mapbox GL JS `Popup`.\n     **/\n    function createPopUp(currentFeature) {\n      var popUps = document.getElementsByClassName('mapboxgl-popup')\n      if (popUps[0]) popUps[0].remove()\n      var popup = new mapboxgl.Popup({ closeOnClick: false })\n        .setLngLat(currentFeature.geometry.coordinates)\n        .setHTML(\n          '<h3>' + currentFeature.properties.name + '</h3>' +\n            '<h5>' + currentFeature.properties.summary + '</h5>' +\n            '<img src=' + currentFeature.properties.img_url + '>' +\n            '<h5>Current conditions: ' + currentFeature.properties.condition + '</h5>'\n        )\n        .addTo(map)\n    }\n  }\n\n\n\n\n  render() {\n    return (\n      <div>\n        <h3>FROM MAP.JS</h3>\n        {/* <div className=\"sidebarStyle\">\n          <div>\n            Longitude: {this.state.lng} | Latitude: {this.state.lat} | Zoom:{' '}\n            {this.state.zoom}\n          </div>\n        </div> */}\n\n        <div className=\"sidebar\">\n          <div className=\"heading\">\n            <h1>Hiking Trails</h1>\n          </div>\n          <div id=\"listings\" className=\"listings\"></div>\n        </div>\n        <div ref={el => (this.mapContainer = el)} className=\"map\" />\n        {/* <div id='map' class='map'></div> */}\n      </div>\n    )\n  }\n}\n\nexport default Map\n"]},"metadata":{},"sourceType":"module"}